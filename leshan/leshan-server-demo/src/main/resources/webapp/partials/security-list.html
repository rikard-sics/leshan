<div class="well well-sm col-md-12" ng-if="certificate">
	<h4>The Leshan Certificate  <small>(x509v3 der encoded)</small>
		<button type="button" title ="Download server certificate(.der)" class="btn btn-default btn-xs" ng-click="saveFile('serverCertificate.der', certificate.bytesDer)">
		<span class="glyphicon glyphicon-download-alt" aria-hidden="true">
		</button>
	</h4>
	<p>
		<div class="col-md-7">
			<u>Hex : </u> <pre>{{certificate.hexDer}}</pre>
		</div>
		<div class="col-md-5">
			<u>Base64 : </u><pre>{{certificate.b64Der}}</pre>
		</div>
		<small>Clients generally need it for X509 authentication.</small><br/>
	</p>
</div>
<div class="well well-sm col-md-12" ng-if="pubkey">
	<h4>The Leshan Public Key <small>(SubjectPublicKeyInfo der encoded)</small>
		<button type="button" title ="Download server public key(.der)" class="btn btn-default btn-xs" ng-click="saveFile('serverPubKey.der',pubkey.bytesDer)">
			<span class="glyphicon glyphicon-download-alt" aria-hidden="true">
		</button>
	</h4>
	<p>
		<u>Elliptic Curve parameters :</u> <code>{{pubkey.params}}</code><br/>
		<u>Public x coord :</u> <code>{{pubkey.x}}</code><br/>
		<u>Public y coord :</u> <code>{{pubkey.y}}</code>
		<div class="col-md-7">
			<u>Hex : </u> <pre>{{pubkey.hexDer}}</pre>
		</div>
		<div class="col-md-5">
			<u>Base64 : </u><pre>{{pubkey.b64Der}}</pre>
		</div>	
		<small>Clients generally need it for RPK authentication.</small>
	</p>
</div>

<div>
	<button class="btn btn-default center-block" ng-click="showModal()" >Add
		new client security configuration</button>
</div>


<div class="table-responsive">
	<table class="table table-striped security-table">
	<thead>
		<tr>
			<th>Client Endpoint</th>
			<th>Security Mode</th>
			<th>Security Information</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="(endpoint, security) in securityInfos">
			<td>{{ endpoint }}</td>
			<td ng-if="security.psk">Pre-Shared Key</td>
			<td ng-if="security.psk">
				Identity : <code style=display:block;white-space:pre-wrap>{{ wrap(security.psk.identity) }}</code>
				Key : <code style=display:block;white-space:pre-wrap>{{ wrap(security.psk.key) }}</code>
			</td>
			<!-- OSCORE fields -->
			<td ng-if="security.oscore">OSCORE</td>
			<td ng-if="security.oscore">
				Master Secret : <code>{{ security.oscore.masterSecret }}</code><br/>
				Master Salt : <code>{{ security.oscore.masterSalt }}</code><br/>
				Sender ID : <code>{{ security.oscore.senderId }}</code><br/>
				Recipient ID : <code>{{ security.oscore.recipientId }}</code><br/>
				AEAD Algorithm : <code>{{ security.oscore.aeadAlgorithm }}</code><br/>
				HKDF Algorithm : <code>{{ security.oscore.hkdfAlgorithm }}</code>
			</td>
			<!-- EDHOC fields -->
			<td ng-if="security.edhoc">EDHOC</td>
			<td ng-if="security.edhoc">
				Initiator : <code>{{ security.edhoc.initiator }}</code><br/>
				Authentication Method : <code>{{ security.edhoc.authenticationMethod }}</code><br/>
				Ciphersuite : <code>{{ security.edhoc.ciphersuite }}</code><br/>
				Credential Identifier : <code>{{ security.edhoc.credentialIdentifier }}</code><br/>
				Public Credential : <code>{{ security.edhoc.publicCredential }}</code><br/>
				Server Credential Identifier : <code>{{ security.edhoc.serverCredentialIdentifier }}</code><br/>
				Server Credential : <code>{{ security.edhoc.serverPublicKey }}</code><br/>
				OSCORE Master Secret Length : <code>{{ security.edhoc.oscoreMasterSecretLength }}</code><br/>
				OSCORE Master Salt Length : <code>{{ security.edhoc.oscoreMasterSaltLength }}</code><br/>
				OSCORE EDHOC Combined : <code>{{ security.edhoc.edhocOscoreCombined }}</code><br/>
			</td>
			<td ng-if="security.rpk">Raw Public Key <br/><small class="text-muted" >(Elliptic Curve)</small></td>
			<td ng-if="security.rpk">Public Key : <br/> <code style=display:block;white-space:pre-wrap>{{wrap(security.rpk.key)}}</code><br/> 
			</td>
			<td ng-if="security.x509">X.509</td>
			<td ng-if="security.x509">Uses X.509 certificate</td>
			<td><button type="button" class="btn btn-default btn-xs" ng-click="remove(endpoint)">
					<span class="glyphicon glyphicon-remove"></button></td>
		</tr>
	<tbody>
	</table>
</div>

<!-- New security modal -->
<div class="modal bs-example-modal-sm" id="newSecurityModal"
	tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-hidden="true">&times;</button>
				<h4 class="modal-title">New security configuration</h4>
			</div>
			
			
     <button type="button" onclick="
         document.getElementById('initiatorValue').value = 'True';
         document.getElementById('authenticationMethodValue').value = '0';
         document.getElementById('ciphersuiteValue').value = '2';
         document.getElementById('credentialIdentifierValue').value = '07';
         document.getElementById('publicCredentialValue').value = '67599A00256435C1E8519F555C47AC1D8B2FC24C65A8382602B865C67FF86054B99B120A187985E732DE7E0EA7E959649DB15DD6ECCFC0D8EEA4662DD2156AF9';
         document.getElementById('serverCredentialIdentifierValue').value = '24';
         document.getElementById('serverPublicKeyValue').value = 'D709BFA1CB5C9B52ED7C29300932F8EC997721E16DC777B470EE64C5DE871B2DF5924DD07D48217FF82197A72EE0B72F2A8A9751DF4B7A1E0745190A3C5628805EF242B57557049C268CC6B861D45B71D823A57A8CE7B4B609910D3EB5064273';
         document.getElementById('oscoreMasterSecretLengthValue').value = '16';
         document.getElementById('oscoreMasterSaltLengthValue').value = '8';
         document.getElementById('edhocOscoreCombinedValue').value = 'False';
         
         document.getElementById('initiatorValue').innerHTML = 'True';
         document.getElementById('authenticationMethodValue').innerHTML = '0';
         document.getElementById('ciphersuiteValue').innerHTML = '2';
         document.getElementById('credentialIdentifierValue').innerHTML = '07';
         document.getElementById('publicCredentialValue').innerHTML = '67599A00256435C1E8519F555C47AC1D8B2FC24C65A8382602B865C67FF86054B99B120A187985E732DE7E0EA7E959649DB15DD6ECCFC0D8EEA4662DD2156AF9';
         document.getElementById('serverCredentialIdentifierValue').innerHTML = '24';
         document.getElementById('serverPublicKeyValue').innerHTML = 'D709BFA1CB5C9B52ED7C29300932F8EC997721E16DC777B470EE64C5DE871B2DF5924DD07D48217FF82197A72EE0B72F2A8A9751DF4B7A1E0745190A3C5628805EF242B57557049C268CC6B861D45B71D823A57A8CE7B4B609910D3EB5064273';
         document.getElementById('oscoreMasterSecretLengthValue').innerHTML = '16';
         document.getElementById('oscoreMasterSaltLengthValue').innerHTML = '8';
         document.getElementById('edhocOscoreCombinedValue').innerHTML = 'False';
         
         document.getElementById('initiatorValue').innerText = 'True';
         document.getElementById('authenticationMethodValue').innerText = '0';
         document.getElementById('ciphersuiteValue').innerText = '2';
         document.getElementById('credentialIdentifierValue').innerText = '07';
         document.getElementById('publicCredentialValue').innerText = '67599A00256435C1E8519F555C47AC1D8B2FC24C65A8382602B865C67FF86054B99B120A187985E732DE7E0EA7E959649DB15DD6ECCFC0D8EEA4662DD2156AF9';
         document.getElementById('serverCredentialIdentifierValue').innerText = '24';
         document.getElementById('serverPublicKeyValue').innerText = 'D709BFA1CB5C9B52ED7C29300932F8EC997721E16DC777B470EE64C5DE871B2DF5924DD07D48217FF82197A72EE0B72F2A8A9751DF4B7A1E0745190A3C5628805EF242B57557049C268CC6B861D45B71D823A57A8CE7B4B609910D3EB5064273';
         document.getElementById('oscoreMasterSecretLengthValue').innerText = '16';
         document.getElementById('oscoreMasterSaltLengthValue').innerText = '8';
         document.getElementById('edhocOscoreCombinedValue').innerText = 'False';
         
         
         document.getElementById('initiator').value = 'True';
         document.getElementById('authenticationMethod').value = '0';
         document.getElementById('ciphersuite').value = '2';
         document.getElementById('credentialIdentifier').value = '07';
         document.getElementById('publicCredential').value = '67599A00256435C1E8519F555C47AC1D8B2FC24C65A8382602B865C67FF86054B99B120A187985E732DE7E0EA7E959649DB15DD6ECCFC0D8EEA4662DD2156AF9';
         document.getElementById('serverCredentialIdentifier').value = '24';
         document.getElementById('serverPublicKey').value = 'D709BFA1CB5C9B52ED7C29300932F8EC997721E16DC777B470EE64C5DE871B2DF5924DD07D48217FF82197A72EE0B72F2A8A9751DF4B7A1E0745190A3C5628805EF242B57557049C268CC6B861D45B71D823A57A8CE7B4B609910D3EB5064273';
         document.getElementById('oscoreMasterSecretLength').value = '16';
         document.getElementById('oscoreMasterSaltLength').value = '8';
         document.getElementById('edhocOscoreCombined').value = 'False';
         
         document.getElementById('initiator').innerHTML = 'True';
         document.getElementById('authenticationMethod').innerHTML = '0';
         document.getElementById('ciphersuite').innerHTML = '2';
         document.getElementById('credentialIdentifier').innerHTML = '07';
         document.getElementById('publicCredential').innerHTML = '67599A00256435C1E8519F555C47AC1D8B2FC24C65A8382602B865C67FF86054B99B120A187985E732DE7E0EA7E959649DB15DD6ECCFC0D8EEA4662DD2156AF9';
         document.getElementById('serverCredentialIdentifier').innerHTML = '24';
         document.getElementById('serverPublicKey').innerHTML = 'D709BFA1CB5C9B52ED7C29300932F8EC997721E16DC777B470EE64C5DE871B2DF5924DD07D48217FF82197A72EE0B72F2A8A9751DF4B7A1E0745190A3C5628805EF242B57557049C268CC6B861D45B71D823A57A8CE7B4B609910D3EB5064273';
         document.getElementById('oscoreMasterSecretLength').innerHTML = '16';
         document.getElementById('oscoreMasterSaltLength').innerHTML = '8';
         document.getElementById('edhocOscoreCombined').innerHTML = 'False';
         
         document.getElementById('initiator').innerText = 'True';
         document.getElementById('authenticationMethod').innerText = '0';
         document.getElementById('ciphersuite').innerText = '2';
         document.getElementById('credentialIdentifier').innerText = '07';
         document.getElementById('publicCredential').innerText = '67599A00256435C1E8519F555C47AC1D8B2FC24C65A8382602B865C67FF86054B99B120A187985E732DE7E0EA7E959649DB15DD6ECCFC0D8EEA4662DD2156AF9';
         document.getElementById('serverCredentialIdentifier').innerText = '24';
         document.getElementById('serverPublicKey').innerText = 'D709BFA1CB5C9B52ED7C29300932F8EC997721E16DC777B470EE64C5DE871B2DF5924DD07D48217FF82197A72EE0B72F2A8A9751DF4B7A1E0745190A3C5628805EF242B57557049C268CC6B861D45B71D823A57A8CE7B4B609910D3EB5064273';
         document.getElementById('oscoreMasterSecretLength').innerText = '16';
         document.getElementById('oscoreMasterSaltLength').innerText = '8';
         document.getElementById('edhocOscoreCombined').innerText = 'False';


         
    ">Fill Client<->DM config</button> 
			
			<div class="modal-body">
				<form class="form form-horizontal" name="form" novalidate>
					<div class="form-group" show-errors> 
						<label for="endpointValue" class="col-sm-4 control-label">Client
							endpoint</label>
						<div class="col-sm-8">
							<input class="form-control" id="endpointValue" name="endpoint" ng-model="endpoint" required>
							<p class="help-block" ng-if="form.endpoint.$error.required">The endpoint is required</p>
						</div>
					</div>
					<div class="form-group">
						<label for="securityMode" class="col-sm-4 control-label">Security
							mode</label>
						<div class="col-sm-8">
							<select class="form-control" id="securityMode" ng-model="securityMode">
								<option value="psk">Pre-Shared Key</option>
								<option value="rpk">Raw Public Key</option>
								<option value="x509">X.509 Certificate</option>
								<!-- Drop-down option for OSCORE security context information -->
								<option value="oscore">OSCORE</option>
								<option value="edhoc">EDHOC</option>
							</select>
						</div>
					</div>

					<!-- PSK inputs -->
					<div class="form-group" ng-class="{'hidden': securityMode!='psk'}" show-errors>
						<label for="pskIdentityValue" class="col-sm-4 control-label">Identity</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="3" id="pskIdentityValue" name="pskIdentity" 
							ng-model="pskIdentity" ng-required="securityMode=='psk'" ng-maxlength="128" ></textarea>
							<p class="help-block" ng-if="form.pskIdentity.$error.required">The PSK identity is required</p>
							<p class="help-block" ng-if="form.pskIdentity.$error.maxlength">The PSK identity is too long</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='psk'}" show-errors>
						<label for="pskValue" class="col-sm-4 control-label">Key</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="3" id="pskValue" name="pskValue" ng-model="pskValue"
							ng-required="securityMode=='psk'" ng-pattern="/^[0-9a-fA-F]+$/" ng-maxlength="128"></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
							<p class="help-block" ng-if="form.pskValue.$error.required">The pre-shared key is required</p>
							<p class="help-block" ng-if="form.pskValue.$error.pattern">Hexadecimal format is expected</p>
							<p class="help-block" ng-if="form.pskValue.$error.maxlength">The pre-shared key is too long</p>
						</div>
					</div>

					<!-- OSCORE inputs -->
					<div class="form-group" ng-class="{'hidden': securityMode!='oscore'}" show-errors>
						<label for="masterSecretValue" class="col-sm-4 control-label">Master Secret</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="2" id="masterSecretValue" name="masterSecret" 
							ng-model="masterSecret" ng-required="securityMode=='oscore'" ng-pattern="/^[0-9a-fA-F]+$/" ng-maxlength="64" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
							<p class="help-block" ng-if="form.masterSecret.$error.required">Master Secret is required</p>
							<p class="help-block" ng-if="form.masterSecret.$error.pattern">Hexadecimal format is expected</p>
							<p class="help-block" ng-if="form.masterSecret.$error.maxlength">Master Secret is too long</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='oscore'}" show-errors>
						<label for="masterSaltValue" class="col-sm-4 control-label">Master Salt</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="2" id="masterSaltValue" name="masterSalt" 
							ng-model="masterSalt" ng-pattern="/^[0-9a-fA-F]+$/" ng-maxlength="64" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
							<p class="help-block" ng-if="form.masterSalt.$error.pattern">Hexadecimal format is expected</p>
							<p class="help-block" ng-if="form.masterSalt.$error.maxlength">Master Salt is too long</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='oscore'}" show-errors>
						<label for="senderIdValue" class="col-sm-4 control-label">Sender ID</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="senderIdValue" name="senderId" 
							ng-model="senderId" ng-required="securityMode=='oscore'" ng-pattern="/^[0-9a-fA-F]+$/" ng-maxlength="16" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
							<p class="help-block" ng-if="form.senderId.$error.required">Sender ID is required</p>
							<p class="help-block" ng-if="form.senderId.$error.pattern">Hexadecimal format is expected</p>
							<p class="help-block" ng-if="form.senderId.$error.maxlength">Sender ID is too long</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='oscore'}" show-errors>
						<label for="recipientIdValue" class="col-sm-4 control-label">Recipient ID</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="recipientIdValue" name="recipientId" 
							ng-model="recipientId" ng-required="securityMode=='oscore'" ng-pattern="/^[0-9a-fA-F]+$/" ng-maxlength="16" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
							<p class="help-block" ng-if="form.recipientId.$error.required">Recipient ID is required</p>
							<p class="help-block" ng-if="form.recipientId.$error.pattern">Hexadecimal format is expected</p>
							<p class="help-block" ng-if="form.recipientId.$error.maxlength">Recipient ID is too long</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='oscore'}" show-errors>
						<label for="aeadAlgorithmValue" class="col-sm-4 control-label">AEAD Algorithm</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="aeadAlgorithmValue" name="aeadAlgorithm" 
							ng-model="aeadAlgorithm" ng-maxlength="32" placeholder="{{defaultAeadAlgorithm}}" ></textarea>
							<p class="help-block" ng-if="form.aeadAlgorithm.$error.maxlength">AEAD Algorithm is too long</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='oscore'}" show-errors>
						<label for="hkdfAlgorithmValue" class="col-sm-4 control-label">HKDF Algorithm</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="hkdfAlgorithmValue" name="hkdfAlgorithm" 
							ng-model="hkdfAlgorithm" ng-maxlength="32" placeholder="{{defaultHkdfAlgorithm}}" ></textarea>
							<p class="help-block" ng-if="form.hkdfAlgorithm.$error.maxlength">HKDF Algorithm is too long</p>
						</div>
					</div>
					
					<!-- EDHOC inputs TODO: Add validation -->
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="initiatorValue" class="col-sm-4 control-label">Initiator</label>
						<div class="col-sm-8">
							<textarea defaultValue="True" class="form-control" style="resize:none" rows="1" id="initiatorValue" name="initiator" 
							ng-model="initiator" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="authenticationMethodValue" class="col-sm-4 control-label">Authentication Method</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="authenticationMethodValue" name="authenticationMethod" 
							ng-model="authenticationMethod" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="ciphersuiteValue" class="col-sm-4 control-label">Ciphersuite</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="ciphersuiteValue" name="ciphersuite" 
							ng-model="ciphersuite" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="credentialIdentifierValue" class="col-sm-4 control-label">Credential Identifier</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="credentialIdentifierValue" name="credentialIdentifier" 
							ng-model="credentialIdentifier" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
						</div>
					</div>

					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="publicCredentialValue" class="col-sm-4 control-label">Public Credential</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="4" id="publicCredentialValue" name="publicCredential" 
							ng-model="publicCredential" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="256" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="serverCredentialIdentifierValue" class="col-sm-4 control-label">Server Credential Identifier</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="serverCredentialIdentifierValue" name="serverCredentialIdentifier" 
							ng-model="serverCredentialIdentifier" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="serverPublicKeyValue" class="col-sm-4 control-label">Server Credential</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="5" id="serverPublicKeyValue" name="serverPublicKey" 
							ng-model="serverPublicKey" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="256" ></textarea>
							<p class="text-right text-muted small" style="margin:0">Hexadecimal format</p>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="oscoreMasterSecretLengthValue" class="col-sm-4 control-label">OSCORE Master Secret Length</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="oscoreMasterSecretLengthValue" name="oscoreMasterSecretLength" 
							ng-model="oscoreMasterSecretLength" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="oscoreMasterSaltLengthValue" class="col-sm-4 control-label">OSCORE Master Salt Length</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="oscoreMasterSaltLengthValue" name="oscoreMasterSaltLength" 
							ng-model="oscoreMasterSaltLength" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
						</div>
					</div>
					
					<div class="form-group" ng-class="{'hidden': securityMode!='edhoc'}" show-errors>
						<label for="edhocOscoreCombinedValue" class="col-sm-4 control-label">EDHOC OSCORE Combined</label>
						<div class="col-sm-8">
							<textarea class="form-control" style="resize:none" rows="1" id="edhocOscoreCombinedValue" name="edhocOscoreCombined" 
							ng-model="edhocOscoreCombined" ng-required="securityMode=='edhoc'" ng-pattern="/^[0-9a-zA-Z]+$/" ng-maxlength="128" ></textarea>
						</div>
					</div>

					<!-- RPK inputs -->
					<div class="form-group"  style="resize:none" ng-class="{'hidden': securityMode!='rpk'}" show-errors>
						<label for="rpkValue" class="col-sm-4 control-label">Client Public Key</label>
						<div class="col-sm-8">
							<textarea class="form-control" rows="3" id="rpkValue" name="rpkValue" ng-model="rpkValue"
							ng-required="securityMode=='rpk'" ng-pattern="/^[0-9a-fA-F]+$/"></textarea>
							<p class="text-right text-muted small" style="margin:0">SubjectPublicKeyInfo der encoded in Hexadecimal</p>
							<p class="help-block" ng-if="form.rpkValue.$error.required">X public key  part is required</p>
							<p class="help-block" ng-if="form.rpkValue.$error.pattern">Hexadecimal format is expected</p>
						</div>
					</div>

					<!-- Certificates input (nothing) -->

				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="newSecuritySubmit" ng-click="save()">Create</button>
			</div>
		</div>
	</div>
</div>


<style>
	.form-group .help-block {
		display: none;
	}
	
	.form-group.has-error .help-block {
		display: block;
	}
</style>
